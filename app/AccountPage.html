<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Account</title>
    <link rel='stylesheet' href='./css/nav.css' type='text/css'>
    <link rel='stylesheet' href='./css/main.css' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src='./js/main.js'></script>
</head>
<body class="addAnItem">
	<div id='nav'>

    </div>
	<h2>My Account Information</h2>
	<table class="postTable" id="myPosts">
		<tr>
			<th>My Posts</th>
		</tr>
		<tr>
			<th>Upvotes</th>
			<th>Downvotes</th>
			<th>Category</th>
			<th>Post</th>
		</tr>
	</table>
	<table class="commentTable" id="myComments">
	<tr>
			<th>My Comments</th>	
	</tr>
    <tr>
            <th>Upvotes</th>
            <th>Downvotes</th>
            <th>Category</th>
            <th>Post</th>
    </tr>
	</table>
	<script>
		function getPosts() {
                $.ajax({
                    type: "GET",
                    url: '/api/get-posts',
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (msg) {
                        console.log(msg);
                        var table = document.getElementById("myPosts");
                        for (i = 0; i < msg.length; i++) {
                            var thisOwner = msg[i].originalPosterID;
                            if (thisOwner == localStorage.getItem("ownerid")) {
                                var upvotes = msg[i].voteCount;
                                var downvotes = msg[i].downVoteCount;
                                var category = msg[i].postCategory;
                                var	post = msg[i].postContent;

                                var row = table.insertRow(2);
                                var upvoteCell = row.insertCell(0);
                                var downvoteCell = row.insertCell(1);
                                var categoryCell = row.insertCell(2);
                                var postCell = row.insertCell(3);

                                // Fill Cells
                                upvoteCell.innerHTML = upvotes;
                                downvoteCell.innerHTML = downvotes;
                                categoryCell.innerHTML = category;
                                postCell.innerHTML = post;
                            }
                        }
                    },
                    error: function (e) {
                        console.log('failure')
                        console.log(e)
                    }
                });
            }

            init();
            getPosts();

	</script>
</body>
</html>